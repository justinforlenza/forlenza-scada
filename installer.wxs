<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="Forlenza SCADA Control System"
           Language="1033"
           Version="2.1.0.0"
           Manufacturer="Forlenza Industrial Systems"
           UpgradeCode="12345678-1234-5678-9012-123456789012"
           InstallerVersion="500"
           Compressed="yes"
           Scope="perMachine">

    <!-- Media Configuration -->
    <MediaTemplate EmbedCab="yes" />

    <!-- Major Upgrade Configuration -->
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <!-- Directory Structure -->
    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLFOLDER" Name="Forlenza Industrial">
        <Directory Id="SCADAFOLDER" Name="SCADA Control System" />
      </Directory>
    </StandardDirectory>

    <!-- Desktop and Start Menu -->
    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="Forlenza Industrial" />
    </StandardDirectory>
    <StandardDirectory Id="DesktopFolder" />

    <!-- Features -->
    <Feature Id="ProductFeature" Title="SCADA Control System">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentGroupRef Id="ShortcutComponents" />
    </Feature>

    <!-- Main Application Components -->
    <ComponentGroup Id="ProductComponents" Directory="SCADAFOLDER">
      <!-- Main Executable -->
      <Component Id="MainExecutable">
        <File Id="ForlenzaSCADAExe"
              Source="target\release\forlenza-scada.exe" />
      </Component>
    </ComponentGroup>

    <!-- Shortcuts -->
    <ComponentGroup Id="ShortcutComponents">
      <!-- Start Menu Shortcut -->
      <Component Id="ApplicationShortcut" Directory="ApplicationProgramsFolder">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="SCADA Control System"
                  Description="Industrial SCADA Control Interface"
                  Target="[#ForlenzaSCADAExe]"
                  WorkingDirectory="SCADAFOLDER"
                  Icon="SCADAIcon.exe" />
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
        <RegistryValue Root="HKCU"
                       Key="Software\Forlenza Industrial\SCADA"
                       Name="installed"
                       Type="integer"
                       Value="1" />
      </Component>

      <!-- Desktop Shortcut -->
      <Component Id="DesktopShortcut" Directory="DesktopFolder">
        <Shortcut Id="ApplicationDesktopShortcut"
                  Name="Forlenza SCADA"
                  Description="Industrial SCADA Control Interface"
                  Target="[#ForlenzaSCADAExe]"
                  WorkingDirectory="SCADAFOLDER"
                  Icon="SCADAIcon.exe" />
        <RegistryValue Root="HKCU"
                       Key="Software\Forlenza Industrial\SCADA"
                       Name="desktop_shortcut"
                       Type="integer"
                       Value="1" />
      </Component>
    </ComponentGroup>

    <!-- Icon Definition -->
    <Icon Id="SCADAIcon.exe" SourceFile="src\icon.ico" />

    <!-- UI Configuration -->
    <Property Id="WIXUI_INSTALLDIR" Value="SCADAFOLDER" />

  </Package>
</Wix>