<!DOCTYPE html>
<!--
    IMPORTANT: IE8 COMPATIBILITY REQUIREMENTS
    ========================================

    This Mock SCADA interface MUST maintain compatibility with Internet Explorer 8.

    When modifying this file, you MUST adhere to the following restrictions:

    CSS RESTRICTIONS:
    - NO CSS3 features (border-radius, box-shadow, gradients, transforms, transitions, animations)
    - NO rgba() colors - use hex colors only (#RRGGBB)
    - NO :nth-child() selectors - use class-based selectors instead
    - NO flexbox or grid layouts - use floats, tables, or absolute positioning
    - NO @media queries for responsive design
    - NO CSS calc() function
    - NO multiple background images

    JAVASCRIPT RESTRICTIONS:
    - NO ES5+ features (forEach, map, filter, reduce, Object.keys, JSON.parse/stringify)
    - NO addEventListener() - use attachEvent() for IE8 or inline event handlers
    - NO querySelector/querySelectorAll - use getElementById, getElementsByTagName, or custom helper functions
    - NO Array.isArray() - use typeof check instead
    - NO console.log() - IE8 console may not exist
    - NO strict mode ("use strict")
    - NO const/let keywords - use var only

    HTML RESTRICTIONS:
    - NO HTML5 semantic elements (header, nav, section, article, aside, footer)
    - NO HTML5 input types (email, url, number, date, etc.) - use text inputs with validation
    - NO data-* attributes beyond basic usage
    - NO placeholder attribute on inputs
-->
<html>

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="UTF-8">
    <title>Forlenza Industrial SCADA Control System</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }

        body {
            font-family: monospace;
            background-color: #2d2d30;
            color: #ffffff;
            overflow: scroll;
            cursor: default;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .clearfix {
            clear: both;
        }

        .content {
            background-color: #3c3c3c;
            padding: 8px;
        }

        /* Menu bar */
        .menubar {
            background-color: #404040;
            border-bottom: 1px solid #606060;
            border-top: 1px solid #808080;
            padding: 0;
            height: 22px;
            font-size: 11px;
            position: fixed;
            top: 0;
            z-index: 1000;
            left: 0;
            right: 0;
        }

        .menu-item {
            display: inline-block;
            padding: 4px 12px;
            font-size: 11px;
            color: #ffffff;
            cursor: default;
            height: 14px;
            line-height: 14px;
            border-right: 1px solid #606060;
            position: relative;
        }

        .menu-item:hover {
            background-color: #0078d4;
            color: #ffffff;
        }

        .menu-item:first-child {
            border-left: 1px solid #606060;
        }

        .menu-dropdown {
            display: none;
            position: absolute;
            top: 22px;
            left: -1px;
            background-color: #404040;
            border: 1px solid #606060;
            border-top: none;
            min-width: 150px;
            z-index: 1000;
        }

        .menu-item:hover .menu-dropdown {
            display: block;
        }

        .dropdown-item {
            display: block;
            padding: 4px 16px;
            font-size: 11px;
            color: #ffffff;
            border-bottom: 1px solid #606060;
            cursor: default;
        }

        .dropdown-item:hover {
            background-color: #0078d4;
            color: #ffffff;
        }

        .dropdown-separator {
            height: 1px;
            background-color: #808080;
            margin: 2px 0;
        }

        /* Status bar */
        .statusbar {
            background-color: #404040;
            border-top: 1px solid #606060;
            padding: 2px 4px;
            font-size: 11px;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 18px;
            color: #ffffff;
        }

        .status-section {
            border: 1px solid;
            border-color: #606060 #808080 #808080 #606060;
            display: inline-block;
            padding: 2px 6px;
            margin-right: 4px;
            background-color: #3c3c3c;
        }

        /* Panels */
        .panel {
            background-color: #3c3c3c;
            border: 2px solid;
            border-color: #606060 #808080 #808080 #606060;
            margin: 8px;
            padding: 4px;
        }

        .panel-title {
            background: #0078d4;
            color: #ffffff;
            padding: 2px 4px;
            font-size: 11px;
            font-weight: bold;
            margin: -4px -4px 4px -4px;
        }

        /* LED indicators */
        .led-panel {
            background-color: #000000;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            padding: 8px;
            margin: 4px;
        }

        .led-row {
            margin: 4px 0;
        }

        .led {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            display: inline-block;
            margin-right: 8px;
            border: 1px solid #404040;
        }

        .led.green-on {
            background-color: #00ff00;
            box-shadow: 0 0 4px #00ff00;
        }

        .led.green-off {
            background-color: #004000;
        }

        .led.red-on {
            background-color: #ff0000;
            box-shadow: 0 0 4px #ff0000;
        }

        .led.red-off {
            background-color: #400000;
        }

        .led.yellow-on {
            background-color: #ffff00;
            box-shadow: 0 0 4px #ffff00;
        }

        .led.yellow-off {
            background-color: #404000;
        }

        .led-label {
            color: #00ff00;
            font-family: "Courier New", monospace;
            font-size: 11px;
            display: inline-block;
            width: 120px;
        }

        /* Digital displays */
        .digital-display {
            background-color: #000000;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            padding: 4px 8px;
            font-family: "Courier New", "Lucida Console", monospace;
            font-size: 16px;
            color: #00ff00;
            text-align: right;
            margin: 4px;
            min-width: 80px;
            display: inline-block;
        }

        .display-label {
            font-size: 11px;
            margin: 2px 4px;
            display: inline-block;
            width: 100px;
        }

        /* Buttons */
        .button {
            background-color: #505050;
            border: 2px solid;
            border-color: #808080 #404040 #404040 #808080;
            padding: 4px 12px;
            font-size: 11px;
            font-family: "Tahoma", "MS Sans Serif", sans-serif;
            color: #ffffff;
            cursor: pointer;
            display: inline-block;
            margin: 2px;
        }

        .button:active {
            border-color: #404040 #808080 #808080 #404040;
            padding: 5px 11px 3px 13px;
        }

        .button.emergency {
            background-color: #ff0000;
            color: #ffffff;
            font-weight: bold;
            padding: 8px 20px;
            font-size: 12px;
        }

        /* Grid layout */
        .grid-container {
            display: table;
            padding: 20px 0;
            width: 100%;
            height: 100vh;
        }

        .grid-row {
            display: table-row;
        }

        .grid-cell {
            display: table-cell;
            vertical-align: top;
            padding: 4px;
        }

        .left-panel {
            width: 220px;
            background-color: #2d2d30;
        }

        .center-left-panel {
            width: 300px;
            background-color: #2d2d30;
        }

        .center-right-panel {
            min-width: 350px;
            background-color: #2d2d30;
        }

        .right-panel {
            width: 280px;
            background-color: #2d2d30;
        }

        /* Alarm list */
        .alarm-list {
            background-color: #000000;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            height: 150px;
            overflow-y: auto;
            padding: 4px;
            margin: 4px;
        }

        .alarm-item {
            color: #ff0000;
            font-family: "Courier New", monospace;
            font-size: 10px;
            padding: 2px 0;
            border-bottom: 1px solid #404040;
            display: table;
            width: 100%;
        }

        .alarm-item.high {
            color: #ff0000;
            background-color: #400000;
        }

        .alarm-item.medium {
            color: #ffff00;
            background-color: #404000;
        }

        .alarm-item.low {
            color: #ffa500;
            background-color: #403000;
        }

        .alarm-item.acknowledged {
            color: #808080;
            background-color: #202020;
        }

        .alarm-time {
            color: #00ffff;
            display: table-cell;
            width: 60px;
        }

        .alarm-priority {
            display: table-cell;
            width: 25px;
            font-weight: bold;
            text-align: center;
        }

        .alarm-text {
            display: table-cell;
        }

        .alarm-ack-btn {
            display: table-cell;
            width: 30px;
            text-align: center;
        }

        .ack-button {
            background-color: #505050;
            border: 1px solid #808080;
            color: #ffffff;
            font-size: 8px;
            padding: 1px 3px;
            cursor: pointer;
        }

        .ack-button:hover {
            background-color: #0078d4;
        }

        .ack-button:active {
            background-color: #005a9e;
        }

        /* Gauge meter */
        .gauge-container {
            display: inline-block;
            margin: 8px;
            text-align: center;
        }

        .gauge-label {
            font-size: 11px;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .gauge-meter {
            width: 120px;
            height: 60px;
            background-color: #000000;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            position: relative;
            overflow: hidden;
        }

        .gauge-scale {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }

        .gauge-needle {
            position: absolute;
            width: 2px;
            height: 50px;
            background-color: #ff0000;
            bottom: 0;
            left: 50%;
        }

        .gauge-value {
            background-color: #000000;
            color: #00ff00;
            font-family: "Courier New", monospace;
            font-size: 12px;
            padding: 2px 4px;
            margin-top: 2px;
            border: 1px solid #808080;
        }

        /* Process table */
        .process-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            margin: 4px 0;
        }

        .process-table th {
            background-color: #0078d4;
            color: #ffffff;
            padding: 2px 4px;
            text-align: left;
            border: 1px solid #606060;
        }

        .process-table td {
            padding: 2px 4px;
            border: 1px solid #606060;
            background-color: #3c3c3c;
            color: #ffffff;
        }

        /* Tank level gauge */
        .tank-gauge {
            width: 80px;
            height: 120px;
            background-color: #000000;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            position: relative;
            display: inline-block;
            margin: 4px;
        }

        .tank-liquid {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #0080ff;
            transition: none;
        }

        .tank-scale {
            position: absolute;
            right: -15px;
            top: 0;
            height: 100%;
            width: 10px;
            font-size: 8px;
            color: #000000;
        }

        .tank-label {
            text-align: center;
            font-size: 10px;
            margin-top: 2px;
            font-weight: bold;
        }

        /* Bar chart */
        .bar-chart {
            background-color: #000000;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            height: 150px;
            padding: 4px;
            margin: 4px;
            position: relative;
            overflow: hidden;
        }

        .bar-chart-bar {
            display: inline-block;
            background-color: #00ff00;
            width: 10%;
            position: absolute;
            bottom: 4px;
        }

        /* Trend chart */
        .trend-chart {
            background-color: #000000;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            height: 120px;
            width: auto;
            padding: 4px;
            margin: 4px;
            position: relative;
            overflow: hidden;
        }

        .trend-line {
            position: absolute;
            height: 2px;
            background-color: #00ff00;
        }

        .trend-grid {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><rect width="20" height="20" fill="none" stroke="%23404040" stroke-width="1"/></svg>');
        }

        /* Valve controls */
        .valve-control {
            display: inline-block;
            margin: 4px;
            text-align: center;
        }

        .valve-symbol {
            width: 40px;
            height: 40px;
            background-color: #c0c0c0;
            border: 2px solid #000000;
            position: relative;
            margin: 0 auto 4px auto;
        }

        .valve-symbol.open {
            background-color: #00ff00;
        }

        .valve-symbol.closed {
            background-color: #ff0000;
        }

        .valve-position {
            font-size: 9px;
            color: #000000;
        }

        /* Process mimic */
        .process-mimic {
            height: 140px;
            background-color: #1e1e1e;
            border: 2px solid;
            border-color: #606060 #808080 #808080 #606060;
            position: relative;
            margin: 4px;
            overflow: hidden;
        }

        .tag-label {
            position: absolute;
            font-size: 8px;
            font-weight: bold;
            background-color: #ffff80;
            padding: 1px 3px;
            border: 1px solid #000000;
            color: #000080;
        }

        .instrument-tag {
            position: absolute;
            font-size: 7px;
            font-family: "Courier New", monospace;
            background-color: #c0ffc0;
            padding: 1px 2px;
            border: 1px solid #008000;
            color: #008000;
        }

        .pipe-horizontal {
            height: 4px;
            background-color: #0080ff;
            border: 1px solid #000000;
            position: absolute;
        }

        .pipe-vertical {
            width: 4px;
            background-color: #0080ff;
            border: 1px solid #000000;
            position: absolute;
        }

        .pipe-recycle {
            background-color: #ffff00;
        }

        .pipe-product {
            background-color: #00ff00;
        }

        .flow-arrow {
            position: absolute;
            color: #ff0000;
            font-size: 10px;
            font-weight: bold;
            background-color: #ffffff;
            border: 1px solid #000000;
            padding: 0 2px;
        }

        .equipment-tank {
            width: 25px;
            height: 35px;
            background-color: #d0d0d0;
            border: 2px solid #000000;
            position: absolute;
        }

        .equipment-tank.active {
            background-color: #a0c0ff;
        }

        .equipment-pump {
            width: 20px;
            height: 20px;
            background-color: #80ff80;
            border: 2px solid #000000;
            position: absolute;
            text-align: center;
            font-size: 10px;
            font-weight: bold;
            line-height: 16px;
        }

        .equipment-pump.running {
            background-color: #40ff40;
            animation: none;
        }

        .equipment-valve {
            width: 14px;
            height: 14px;
            background-color: #ffff80;
            border: 2px solid #000000;
            position: absolute;
            transform: rotate(45deg);
        }

        .equipment-valve.open {
            background-color: #80ff80;
        }

        .equipment-valve.closed {
            background-color: #ff8080;
        }

        .equipment-reactor {
            width: 40px;
            height: 45px;
            background-color: #ff9090;
            border: 2px solid #000000;
            position: absolute;
        }

        .equipment-reactor.active {
            background-color: #ff6060;
        }

        .equipment-heat-exchanger {
            width: 30px;
            height: 20px;
            background-color: #c0c0ff;
            border: 2px solid #000000;
            position: absolute;
        }

        .equipment-sensor {
            width: 8px;
            height: 8px;
            background-color: #ffa500;
            border: 1px solid #000000;
            position: absolute;
        }

        .equipment-label {
            position: absolute;
            font-size: 8px;
            font-weight: bold;
            background-color: #404040;
            color: #ffffff;
            padding: 1px 2px;
            border: 1px solid #808080;
        }

        /* Motor status */
        .motor-status {
            background-color: #000000;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            padding: 4px;
            margin: 4px;
            color: #00ff00;
            font-family: "Courier New", monospace;
            font-size: 10px;
        }

        .motor-running {
            color: #00ff00;
        }

        .motor-stopped {
            color: #ff0000;
        }

        /* Control sliders */
        .control-slider {
            width: 100px;
            height: 20px;
            background-color: #c0c0c0;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            position: relative;
            margin: 4px;
        }

        .slider-track {
            width: 96px;
            height: 4px;
            background-color: #808080;
            position: absolute;
            top: 6px;
            left: 2px;
        }

        .slider-thumb {
            width: 8px;
            height: 16px;
            background-color: #000080;
            position: absolute;
            top: 2px;
            cursor: pointer;
        }

        /* Additional gauge types */
        .vibration-gauge {
            width: 100px;
            height: 50px;
            background-color: #000000;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            position: relative;
            margin: 4px;
        }

        .vibration-bar {
            position: absolute;
            bottom: 0;
            background-color: #00ff00;
            width: 4px;
            margin: 0 1px;
        }

        .vibration-bar.high {
            background-color: #ff0000;
        }

        .vibration-bar.medium {
            background-color: #ffff00;
        }

        /* Scrollbar styling for IE */
        .alarm-list {
            scrollbar-face-color: #c0c0c0;
            scrollbar-track-color: #808080;
            scrollbar-arrow-color: #000000;
            scrollbar-3dlight-color: #ffffff;
            scrollbar-darkshadow-color: #000000;
            scrollbar-highlight-color: #ffffff;
            scrollbar-shadow-color: #808080;
        }
    </style>
</head>

<body>

    <div class="menubar">
        <div class="menu-item">
            File
            <div class="menu-dropdown">
                <div class="dropdown-item" onclick="menuAction('file-new')">New Project</div>
                <div class="dropdown-item" onclick="menuAction('file-open')">Open Project</div>
                <div class="dropdown-item" onclick="menuAction('file-save')">Save Project</div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="menuAction('file-export')">Export Data</div>
                <div class="dropdown-item" onclick="menuAction('file-print')">Print Screen</div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="menuAction('file-exit')">Exit</div>
            </div>
        </div>
        <div class="menu-item">
            View
            <div class="menu-dropdown">
                <div class="dropdown-item" onclick="menuAction('view-overview')">Process Overview</div>
                <div class="dropdown-item" onclick="menuAction('view-trends')">Trend Display</div>
                <div class="dropdown-item" onclick="menuAction('view-alarms')">Alarm Summary</div>
                <div class="dropdown-item" onclick="menuAction('view-reports')">Reports</div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="menuAction('view-fullscreen')">Full Screen</div>
                <div class="dropdown-item" onclick="menuAction('view-refresh')">Refresh Display</div>
            </div>
        </div>
        <div class="menu-item">
            Control
            <div class="menu-dropdown">
                <div class="dropdown-item" onclick="menuAction('control-auto')">Auto Mode</div>
                <div class="dropdown-item" onclick="menuAction('control-manual')">Manual Mode</div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="menuAction('control-start')">Start Process</div>
                <div class="dropdown-item" onclick="menuAction('control-stop')">Stop Process</div>
                <div class="dropdown-item" onclick="menuAction('control-estop')">Emergency Stop</div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="menuAction('control-setpoints')">Setpoint Editor</div>
            </div>
        </div>
        <div class="menu-item">
            Alarms
            <div class="menu-dropdown">
                <div class="dropdown-item" onclick="menuAction('alarm-active')">Active Alarms</div>
                <div class="dropdown-item" onclick="menuAction('alarm-history')">Alarm History</div>
                <div class="dropdown-item" onclick="menuAction('alarm-ack-all')">Acknowledge All</div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="menuAction('alarm-config')">Alarm Configuration</div>
                <div class="dropdown-item" onclick="menuAction('alarm-silence')">Silence Horn</div>
            </div>
        </div>
        <div class="menu-item">
            Tools
            <div class="menu-dropdown">
                <div class="dropdown-item" onclick="menuAction('tools-calibrate')">Calibration</div>
                <div class="dropdown-item" onclick="menuAction('tools-diagnostics')">Diagnostics</div>
                <div class="dropdown-item" onclick="menuAction('tools-backup')">Backup Database</div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="menuAction('tools-settings')">System Settings</div>
                <div class="dropdown-item" onclick="menuAction('tools-users')">User Management</div>
            </div>
        </div>
        <div class="menu-item">
            Help
            <div class="menu-dropdown">
                <div class="dropdown-item" onclick="menuAction('help-manual')">User Manual</div>
                <div class="dropdown-item" onclick="menuAction('help-shortcuts')">Keyboard Shortcuts</div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="menuAction('help-about')">About SCADA</div>
            </div>
        </div>
    </div>

    <div class="grid-container">
        <div class="grid-row">
            <div class="grid-cell left-panel">
                <div class="panel">
                    <div class="panel-title">SYSTEM STATUS</div>
                    <div class="led-panel">
                        <div class="led-row">
                            <span class="led green-on" id="led1"></span>
                            <span class="led-label">SYS ONLINE</span>
                        </div>
                        <div class="led-row">
                            <span class="led green-on" id="led2"></span>
                            <span class="led-label">PLC COMM</span>
                        </div>
                        <div class="led-row">
                            <span class="led yellow-on" id="led3"></span>
                            <span class="led-label">PUMP A</span>
                        </div>
                        <div class="led-row">
                            <span class="led green-off" id="led4"></span>
                            <span class="led-label">PUMP B</span>
                        </div>
                        <div class="led-row">
                            <span class="led red-off" id="led5"></span>
                            <span class="led-label">ALARM</span>
                        </div>
                        <div class="led-row">
                            <span class="led green-on" id="led6"></span>
                            <span class="led-label">COOLING</span>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-title">CONTROL</div>
                    <center>
                        <button class="button" onclick="buttonClick('START')">START</button>
                        <button class="button" onclick="buttonClick('STOP')">STOP</button>
                        <button class="button" onclick="buttonClick('RESET')">RESET</button>
                    </center>
                    <center>
                        <button class="button emergency" onclick="emergencyStop()">EMERGENCY<br />STOP</button>
                    </center>
                </div>

                <div class="panel">
                    <div class="panel-title">VALVE CONTROLS</div>
                    <div style="text-align: center;">
                        <div class="valve-control">
                            <div class="valve-symbol open" id="valve1" onclick="toggleValve('valve1')"></div>
                            <div class="valve-position">VLV-101<br />OPEN</div>
                        </div>
                        <div class="valve-control">
                            <div class="valve-symbol closed" id="valve2" onclick="toggleValve('valve2')"></div>
                            <div class="valve-position">VLV-102<br />CLOSED</div>
                        </div>
                        <div class="valve-control">
                            <div class="valve-symbol open" id="valve3" onclick="toggleValve('valve3')"></div>
                            <div class="valve-position">VLV-103<br />OPEN</div>
                        </div>
                        <div class="valve-control">
                            <div class="valve-symbol closed" id="valve4" onclick="toggleValve('valve4')"></div>
                            <div class="valve-position">VLV-104<br />CLOSED</div>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-title">CONTROL SETPOINTS</div>
                    <div style="padding: 4px;">
                        <div style="margin: 4px 0;">
                            <span style="font-size: 10px; width: 80px; display: inline-block;">TEMP SP:</span>
                            <input type="text" value="180.0" style="width: 60px; font-size: 10px;" id="temp-sp" />
                            <span style="font-size: 10px;">°C</span>
                        </div>
                        <div style="margin: 4px 0;">
                            <span style="font-size: 10px; width: 80px; display: inline-block;">PRESS SP:</span>
                            <input type="text" value="2.50" style="width: 60px; font-size: 10px;" id="press-sp" />
                            <span style="font-size: 10px;">bar</span>
                        </div>
                        <div style="margin: 4px 0;">
                            <span style="font-size: 10px; width: 80px; display: inline-block;">FLOW SP:</span>
                            <input type="text" value="850" style="width: 60px; font-size: 10px;" id="flow-sp" />
                            <span style="font-size: 10px;">L/m</span>
                        </div>
                        <div style="margin: 4px 0;">
                            <span style="font-size: 10px; width: 80px; display: inline-block;">LEVEL SP:</span>
                            <input type="text" value="70.0" style="width: 60px; font-size: 10px;" id="level-sp" />
                            <span style="font-size: 10px;">%</span>
                        </div>
                        <button class="button" onclick="buttonClick('UPDATE_SP')"
                            style="margin-top: 4px;">UPDATE</button>
                    </div>
                </div>
            </div>

            <div class="grid-cell center-right-panel">
                <div class="panel">
                    <div class="panel-title">PROCESS MIMIC - REACTOR UNIT #1</div>
                    <div class="process-mimic">
                        <!-- Feed Tank FT-01 -->
                        <div class="equipment-tank active" style="top: 25px; left: 15px;"></div>
                        <div class="equipment-label" style="top: 65px; left: 12px;">FT-101</div>

                        <!-- Feed line from tank -->
                        <div class="pipe-horizontal" style="width: 20px; top: 42px; left: 42px;"></div>
                        <div class="flow-arrow" style="top: 38px; left: 47px;">→</div>

                        <!-- Feed Pump P-01 -->
                        <div class="equipment-pump running" style="top: 34px; left: 67px;">P</div>
                        <div class="equipment-label" style="top: 57px; left: 64px;">P-101</div>

                        <!-- Line to Control Valve -->
                        <div class="pipe-horizontal" style="width: 15px; top: 42px; left: 92px;"></div>
                        <div class="flow-arrow" style="top: 38px; left: 97px;">→</div>

                        <!-- Control Valve FV-101 -->
                        <div class="equipment-valve open" style="top: 36px; left: 112px;"></div>
                        <div class="equipment-label" style="top: 55px; left: 107px;">FV-101</div>

                        <!-- Line to Reactor -->
                        <div class="pipe-horizontal" style="width: 20px; top: 42px; left: 130px;"></div>
                        <div class="flow-arrow" style="top: 38px; left: 135px;">→</div>

                        <!-- Reactor R-01 -->
                        <div class="equipment-reactor active" style="top: 20px; left: 155px;"></div>
                        <div class="equipment-label" style="top: 70px; left: 164px;">R-101</div>

                        <!-- Heat Exchanger -->
                        <div class="equipment-heat-exchanger" style="top: 90px; left: 160px;"></div>
                        <div class="equipment-label" style="top: 115px; left: 164px;">HX-101</div>

                        <!-- Product line from reactor -->
                        <div class="pipe-horizontal pipe-product" style="width: 20px; top: 42px; left: 200px;"></div>
                        <div class="flow-arrow" style="top: 38px; left: 205px;">→</div>

                        <!-- Product Valve PV-102 -->
                        <div class="equipment-valve open" style="top: 36px; left: 225px;"></div>
                        <div class="equipment-label" style="top: 55px; left: 220px;">PV-102</div>

                        <!-- Line to Product Tank -->
                        <div class="pipe-horizontal pipe-product" style="width: 15px; top: 42px; left: 243px;"></div>
                        <div class="flow-arrow" style="top: 38px; left: 248px;">→</div>

                        <!-- Product Tank PT-01 -->
                        <div class="equipment-tank active" style="top: 25px; left: 263px;"></div>
                        <div class="equipment-label" style="top: 65px; left: 258px;">PT-101</div>

                        <!-- Recirculation line -->
                        <div class="pipe-vertical pipe-recycle" style="height: 25px; top: 47px; left: 175px;"></div>
                        <div class="pipe-horizontal pipe-recycle" style="width: 115px; top: 72px; left: 57px;"></div>
                        <div class="pipe-vertical pipe-recycle" style="height: 25px; top: 47px; left: 77px;"></div>
                        <div class="flow-arrow" style="top: 68px; left: 100px;">←</div>
                        <div class="flow-arrow" style="top: 53px; left: 171px;">↓</div>
                        <div class="flow-arrow" style="top: 53px; left: 73px;">↑</div>

                        <!-- Flow indicators -->
                        <div style="position: absolute; top: 25px; left: 45px; font-size: 8px; color: #0000ff;">850 L/m</div>
                        <div style="position: absolute; top: 25px; left: 200px; font-size: 8px; color: #008000;">620 L/m</div>
                        <div style="position: absolute; top: 85px; left: 100px; font-size: 8px; color: #cccc00;">230 L/m</div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-title">PROCESS VALUES</div>

                    <div style="text-align: center;">
                        <div class="gauge-container">
                            <div class="gauge-label">TT-201 REACTOR</div>
                            <div class="gauge-meter">
                                <div class="gauge-needle" id="temp-needle"></div>
                            </div>
                            <div class="gauge-value" id="temp-value">178.5°C</div>
                        </div>

                        <div class="gauge-container">
                            <div class="gauge-label">PT-201 REACTOR</div>
                            <div class="gauge-meter">
                                <div class="gauge-needle" id="pressure-needle"></div>
                            </div>
                            <div class="gauge-value" id="pressure-value">2.4 BAR</div>
                        </div>

                        <div class="gauge-container">
                            <div class="gauge-label">FT-101 FEED</div>
                            <div class="gauge-meter">
                                <div class="gauge-needle" id="flow-needle"></div>
                            </div>
                            <div class="gauge-value" id="flow-value">847 L/m</div>
                        </div>
                    </div>

                    <div style="margin-top: 10px;">
                        <span class="display-label">TT-201 REACTOR:</span>
                        <span class="digital-display" id="reactor-temp">0185.7</span>
                        <span style="font-size: 9px;">°C</span>
                        <span class="display-label">TT-301 COOLANT:</span>
                        <span class="digital-display" id="coolant-temp">0045.2</span>
                        <span style="font-size: 9px;">°C</span>
                        <br />
                        <span class="display-label">PT-201 REACTOR:</span>
                        <span class="digital-display" id="sys-pressure">002.45</span>
                        <span style="font-size: 9px;">bar</span>
                        <span class="display-label">FQT-101 TOTAL:</span>
                        <span class="digital-display" id="flow-total">48576</span>
                        <span style="font-size: 9px;">L</span>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-title">TREND CHARTS</div>
                    <div class="trend-chart" id="trend-chart">
                        <div class="trend-grid"></div>
                        <canvas id="trend-canvas"
                            style="position: absolute; top: 4px; left: 4px; right: 4px; bottom: 4px;"></canvas>
                    </div>
                    <div style="font-size: 9px; text-align: center; margin-top: 4px;">
                        <span style="color: #00ff00;">TEMP</span> |
                        <span style="color: #ffff00;">PRESS</span> |
                        <span style="color: #ff0000;">FLOW</span> |
                        <span style="color: #00ffff;">LEVEL</span>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-title">PRODUCTION CHART</div>
                    <div class="bar-chart" id="bar-chart">
                        <div class="bar-chart-bar" id="bar1" style="left: 2%; height: 60px;"></div>
                        <div class="bar-chart-bar" id="bar2" style="left: 14%; height: 45px;"></div>
                        <div class="bar-chart-bar" id="bar3" style="left: 26%; height: 75px;"></div>
                        <div class="bar-chart-bar" id="bar4" style="left: 38%; height: 55px;"></div>
                        <div class="bar-chart-bar" id="bar5" style="left: 50%; height: 80px;"></div>
                        <div class="bar-chart-bar" id="bar6" style="left: 62%; height: 65px;"></div>
                        <div class="bar-chart-bar" id="bar7" style="left: 74%; height: 70px;"></div>
                        <div class="bar-chart-bar" id="bar8" style="left: 86%; height: 50px;"></div>
                    </div>
                    <div style="font-size: 9px; text-align: center; margin-top: 4px;">HOURLY PRODUCTION (UNITS)</div>
                </div>


            </div>

            <div class="grid-cell center-left-panel">
                <div class="panel">
                    <div class="panel-title">ADDITIONAL MONITORS</div>

                    <div style="text-align: center;">
                        <div class="gauge-container">
                            <div class="gauge-label">VT-101 P-101</div>
                            <div class="vibration-gauge" id="vibration-display">
                                <div class="vibration-bar" id="vib-bar-1" style="left: 5px; height: 20px;"></div>
                                <div class="vibration-bar" id="vib-bar-2" style="left: 10px; height: 15px;"></div>
                                <div class="vibration-bar" id="vib-bar-3" style="left: 15px; height: 25px;"></div>
                                <div class="vibration-bar" id="vib-bar-4" style="left: 20px; height: 18px;"></div>
                                <div class="vibration-bar" id="vib-bar-5" style="left: 25px; height: 22px;"></div>
                                <div class="vibration-bar" id="vib-bar-6" style="left: 30px; height: 16px;"></div>
                                <div class="vibration-bar" id="vib-bar-7" style="left: 35px; height: 19px;"></div>
                                <div class="vibration-bar" id="vib-bar-8" style="left: 40px; height: 24px;"></div>
                                <div class="vibration-bar" id="vib-bar-9" style="left: 45px; height: 17px;"></div>
                                <div class="vibration-bar" id="vib-bar-10" style="left: 50px; height: 21px;"></div>
                            </div>
                            <div class="gauge-value" id="vibration-value">0.8 mm/s</div>
                        </div>

                        <div class="gauge-container">
                            <div class="gauge-label">WT-101 MOTOR</div>
                            <div class="gauge-meter">
                                <div class="gauge-needle" id="power-needle"></div>
                            </div>
                            <div class="gauge-value" id="power-value">245 kW</div>
                        </div>

                        <div class="gauge-container">
                            <div class="gauge-label">AT-201 REACTOR</div>
                            <div class="gauge-meter">
                                <div class="gauge-needle" id="ph-needle"></div>
                            </div>
                            <div class="gauge-value" id="ph-value">7.2 pH</div>
                        </div>
                    </div>

                    <div style="margin-top: 10px; text-align: center;">
                        <div class="tank-gauge" style="display: inline-block;">
                            <div class="tank-liquid" id="tank1-level" style="height: 65%;"></div>
                            <div class="tank-scale">
                                <div style="position: absolute; top: 0;">100</div>
                                <div style="position: absolute; top: 25%;">75</div>
                                <div style="position: absolute; top: 50%;">50</div>
                                <div style="position: absolute; top: 75%;">25</div>
                                <div style="position: absolute; bottom: 0;">0</div>
                            </div>
                        </div>
                        <div class="tank-label">LT-101<br />FEED TANK<br /><span id="tank1-value">65.2%</span></div>

                        <div class="tank-gauge" style="display: inline-block;">
                            <div class="tank-liquid" id="tank2-level" style="height: 43%;"></div>
                            <div class="tank-scale">
                                <div style="position: absolute; top: 0;">100</div>
                                <div style="position: absolute; top: 25%;">75</div>
                                <div style="position: absolute; top: 50%;">50</div>
                                <div style="position: absolute; top: 75%;">25</div>
                                <div style="position: absolute; bottom: 0;">0</div>
                            </div>
                        </div>
                        <div class="tank-label">LT-201<br />REACTOR<br /><span id="tank2-value">43.8%</span></div>

                        <div class="tank-gauge" style="display: inline-block;">
                            <div class="tank-liquid" id="tank3-level" style="height: 78%;"></div>
                            <div class="tank-scale">
                                <div style="position: absolute; top: 0;">100</div>
                                <div style="position: absolute; top: 25%;">75</div>
                                <div style="position: absolute; top: 50%;">50</div>
                                <div style="position: absolute; top: 75%;">25</div>
                                <div style="position: absolute; bottom: 0;">0</div>
                            </div>
                        </div>
                        <div class="tank-label">LT-301<br />PRODUCT<br /><span id="tank3-value">78.1%</span></div>
                    </div>
                </div>


            </div>


            <div class="grid-cell right-panel">
                <div class="panel">
                    <div class="panel-title">RUNTIME</div>
                    <div style="padding: 4px; font-size: 11px;">
                        <div>System: <span id="runtime">147:23:16</span></div>
                        <div>Batch: <span id="batchtime">008:45:32</span></div>
                        <div>Cycle: <span id="cycletime">000:12:48</span></div>
                        <div>Maintenance: <span id="maint-time">72:15:00</span></div>
                    </div>
                </div>
                <div class="panel">
                    <div class="panel-title">MOTOR STATUS</div>
                    <div class="motor-status">
                        <div class="motor-running">PUMP-01: RUNNING 125.4A 1782RPM</div>
                        <div class="motor-running">PUMP-02: RUNNING 98.7A 1756RPM</div>
                        <div class="motor-stopped">PUMP-03: STOPPED 0.0A 0RPM</div>
                        <div class="motor-running">FAN-01: RUNNING 45.2A 890RPM</div>
                        <div class="motor-running">FAN-02: RUNNING 44.8A 895RPM</div>
                    </div>
                </div>



                <div class="panel">
                    <div class="panel-title">ACTIVE ALARMS [3 UNACK]</div>
                    <div class="alarm-list" id="alarm-list">
                        <div class="alarm-item high" id="alarm-1">
                            <span class="alarm-time">14:23:45</span>
                            <span class="alarm-priority">H</span>
                            <span class="alarm-text">TT-201 HIGH TEMP - REACTOR</span>
                            <span class="alarm-ack-btn"><button class="ack-button" onclick="ackAlarm('alarm-1')">ACK</button></span>
                        </div>
                        <div class="alarm-item medium" id="alarm-2">
                            <span class="alarm-time">14:18:12</span>
                            <span class="alarm-priority">M</span>
                            <span class="alarm-text">PT-201 LOW PRESSURE - LINE 4</span>
                            <span class="alarm-ack-btn"><button class="ack-button" onclick="ackAlarm('alarm-2')">ACK</button></span>
                        </div>
                        <div class="alarm-item low" id="alarm-3">
                            <span class="alarm-time">13:55:08</span>
                            <span class="alarm-priority">L</span>
                            <span class="alarm-text">VLV-502 POSITION FAULT</span>
                            <span class="alarm-ack-btn"><button class="ack-button" onclick="ackAlarm('alarm-3')">ACK</button></span>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 4px;">
                        <button class="button" onclick="acknowledgeAll()" style="font-size: 9px; padding: 2px 8px;">ACK ALL</button>
                        <button class="button" onclick="clearAcknowledged()" style="font-size: 9px; padding: 2px 8px;">CLEAR</button>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-title">EFFICIENCY METRICS</div>
                    <table class="process-table">
                        <tr>
                            <th>Metric</th>
                            <th>Value</th>
                        </tr>
                        <tr>
                            <td>OEE</td>
                            <td id="oee-value">87.3%</td>
                        </tr>
                        <tr>
                            <td>Production Rate</td>
                            <td id="prod-rate">245 units/hr</td>
                        </tr>
                        <tr>
                            <td>Energy Usage</td>
                            <td id="energy-usage">1247 kWh</td>
                        </tr>
                        <tr>
                            <td>Efficiency</td>
                            <td id="efficiency">94.2%</td>
                        </tr>
                    </table>
                </div>


            </div>
        </div>

        <div class="statusbar">
            <span class="status-section">PLC COMM: ONLINE</span>
            <span class="status-section">HMI NODE: WS-01</span>
            <span class="status-section">MODE: AUTOMATIC</span>
            <span class="status-section">USER: OPERATOR_01</span>
            <span class="status-section">STATION: REACTOR_CTRL</span>
            <span class="status-section">ALARMS: <span id="status-alarms">3</span></span>
            <span class="status-section" id="clock">00:00:00</span>
        </div>
    </div>

    <script type="text/javascript">
        // IE8-compatible getElementsByClassName replacement
        function getElementByClassName(className, parentElement) {
            var parent = parentElement || document;
            var elements = parent.getElementsByTagName('*');
            var results = [];
            for (var i = 0; i < elements.length; i++) {
                if (elements[i].className && elements[i].className.indexOf(className) !== -1) {
                    // Check if className is a whole word, not just a substring
                    var classNames = elements[i].className.split(' ');
                    for (var j = 0; j < classNames.length; j++) {
                        if (classNames[j] === className) {
                            results.push(elements[i]);
                            break;
                        }
                    }
                }
            }
            return results;
        }

        // Clock update
        function updateClock() {
            var now = new Date();
            var hours = ('0' + now.getHours()).slice(-2);
            var minutes = ('0' + now.getMinutes()).slice(-2);
            var seconds = ('0' + now.getSeconds()).slice(-2);
            document.getElementById('clock').innerHTML = hours + ':' + minutes + ':' + seconds;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // IE8-compatible needle rotation function
        function rotateNeedle(elementId, degrees) {
            var element = document.getElementById(elementId);

            // Check if browser supports standard transform
            if (element.style.transform !== undefined) {
                element.style.transform = 'rotate(' + degrees + 'deg)';
            }
            // IE8 fallback using filter
            else if (element.style.filter !== undefined) {
                // Convert degrees to radians for IE8 matrix
                var radians = degrees * (Math.PI / 180);
                var cos = Math.cos(radians);
                var sin = Math.sin(radians);

                // IE8 Matrix filter for rotation
                element.style.filter = 'progid:DXImageTransform.Microsoft.Matrix(' +
                    'M11=' + cos + ',' +
                    'M12=' + (-sin) + ',' +
                    'M21=' + sin + ',' +
                    'M22=' + cos + ',' +
                    'SizingMethod="auto expand")';

                // Adjust position to maintain rotation around bottom center
                var rect = element.parentNode.getBoundingClientRect ? element.parentNode.getBoundingClientRect() : { width: 120, height: 60 };
                var centerX = rect.width ? rect.width / 2 : 60;
                var centerY = rect.height ? rect.height : 60;

                element.style.left = (centerX - 1) + 'px';
                element.style.bottom = '0px';
            }
        }

        // LED blinking
        function toggleLED(id) {
            var led = document.getElementById(id);
            if (led.className.indexOf('yellow') > -1) {
                led.className = led.className.indexOf('-on') > -1 ? 'led yellow-off' : 'led yellow-on';
            }
        }
        setInterval(function () { toggleLED('led3'); }, 1000);
        setInterval(function () { toggleLED('led5'); }, 500);

        // Update values
        function updateValues() {
            // Temperature
            var temp = 170 + Math.random() * 20;
            document.getElementById('temp-value').innerHTML = temp.toFixed(1) + '°C';
            document.getElementById('reactor-temp').innerHTML = ('0000' + temp.toFixed(1)).slice(-6);
            // document.getElementById('tt201').innerHTML = temp.toFixed(1);
            var tempAngle = -45 + (temp - 170) * 4.5;
            rotateNeedle('temp-needle', tempAngle);

            // Pressure
            var pressure = 2.0 + Math.random() * 1.0;
            document.getElementById('pressure-value').innerHTML = pressure.toFixed(1) + ' BAR';
            document.getElementById('sys-pressure').innerHTML = ('00' + pressure.toFixed(2)).slice(-6);
            // document.getElementById('pt101').innerHTML = pressure.toFixed(2);
            var pressAngle = -45 + (pressure - 2.0) * 90;
            rotateNeedle('pressure-needle', pressAngle);

            // Flow
            var flow = 800 + Math.random() * 100;
            document.getElementById('flow-value').innerHTML = Math.round(flow) + ' L/m';
            // document.getElementById('ft301').innerHTML = flow.toFixed(1);
            var flowAngle = -45 + (flow - 800) * 0.9;
            rotateNeedle('flow-needle', flowAngle);

            // Other values
            document.getElementById('coolant-temp').innerHTML = ('0000' + (40 + Math.random() * 10).toFixed(1)).slice(-6);
            // document.getElementById('lt401').innerHTML = (60 + Math.random() * 20).toFixed(1);
            // document.getElementById('vlv501').innerHTML = (40 + Math.random() * 20).toFixed(1);

            var total = parseInt(document.getElementById('flow-total').innerHTML);
            document.getElementById('flow-total').innerHTML = ('00000' + (total + Math.round(flow / 60))).slice(-5);
        }
        setInterval(updateValues, 2000);
        updateValues();

        // Runtime counters
        function updateRuntime() {
            var runtime = document.getElementById('runtime').innerHTML.split(':');
            var hours = parseInt(runtime[0]);
            var minutes = parseInt(runtime[1]);
            var seconds = parseInt(runtime[2]);

            seconds++;
            if (seconds >= 60) {
                seconds = 0;
                minutes++;
                if (minutes >= 60) {
                    minutes = 0;
                    hours++;
                }
            }

            document.getElementById('runtime').innerHTML =
                ('000' + hours).slice(-3) + ':' +
                ('00' + minutes).slice(-2) + ':' +
                ('00' + seconds).slice(-2);
        }
        setInterval(updateRuntime, 1000);

        // Menu handler
        function menuAction(action) {
            switch(action) {
                case 'file-new':
                    alert('SCADA SYSTEM\n\nCreate new project configuration.');
                    break;
                case 'file-open':
                    alert('SCADA SYSTEM\n\nSelect project file to open.');
                    break;
                case 'file-save':
                    alert('SCADA SYSTEM\n\nProject configuration saved.');
                    break;
                case 'file-export':
                    alert('SCADA SYSTEM\n\nExporting historical data...');
                    break;
                case 'file-print':
                    window.print();
                    break;
                case 'file-exit':
                    if (confirm('Exit SCADA Application?\n\nAre you sure?')) {
                        alert('SCADA SYSTEM\n\nShutting down safely...');
                    }
                    break;
                case 'view-overview':
                    alert('SCADA SYSTEM\n\nSwitching to Process Overview.');
                    break;
                case 'view-trends':
                    alert('SCADA SYSTEM\n\nOpening Trend Display.');
                    break;
                case 'view-alarms':
                    alert('SCADA SYSTEM\n\nDisplaying Alarm Summary.');
                    break;
                case 'view-reports':
                    alert('SCADA SYSTEM\n\nGenerating Production Reports.');
                    break;
                case 'view-fullscreen':
                    alert('SCADA SYSTEM\n\nToggling full screen mode.');
                    break;
                case 'view-refresh':
                    location.reload();
                    break;
                case 'control-auto':
                    alert('SCADA CONTROL\n\nSwitching to Automatic Mode.');
                    break;
                case 'control-manual':
                    alert('SCADA CONTROL\n\nSwitching to Manual Mode.');
                    break;
                case 'control-start':
                    alert('SCADA CONTROL\n\nStarting process sequence.');
                    break;
                case 'control-stop':
                    alert('SCADA CONTROL\n\nStopping process sequence.');
                    break;
                case 'control-estop':
                    emergencyStop();
                    break;
                case 'control-setpoints':
                    alert('SCADA CONTROL\n\nOpening Setpoint Editor.');
                    break;
                case 'alarm-active':
                    alert('SCADA ALARMS\n\nDisplaying active alarms.');
                    break;
                case 'alarm-history':
                    alert('SCADA ALARMS\n\nOpening alarm history.');
                    break;
                case 'alarm-ack-all':
                    alert('SCADA ALARMS\n\nAcknowledging all active alarms.');
                    break;
                case 'alarm-config':
                    alert('SCADA ALARMS\n\nOpening alarm configuration.');
                    break;
                case 'alarm-silence':
                    alert('SCADA ALARMS\n\nSilencing alarm horn.');
                    break;
                case 'tools-calibrate':
                    alert('SCADA TOOLS\n\nStarting instrument calibration.');
                    break;
                case 'tools-diagnostics':
                    alert('SCADA TOOLS\n\nRunning system diagnostics.');
                    break;
                case 'tools-backup':
                    alert('SCADA TOOLS\n\nBacking up system database.');
                    break;
                case 'tools-settings':
                    alert('SCADA TOOLS\n\nOpening system settings.');
                    break;
                case 'tools-users':
                    alert('SCADA TOOLS\n\nUser management interface.');
                    break;
                case 'help-manual':
                    alert('SCADA HELP\n\nOpening user manual.');
                    break;
                case 'help-shortcuts':
                    alert('SCADA HELP\n\nKeyboard Shortcuts:\nF1 - Help\nF5 - Refresh\nF11 - Full Screen\nESC - Emergency Stop');
                    break;
                case 'help-about':
                    alert('Forlenza Industrial SCADA Control System\nVersion 2.1\n\nCopyright 2007 Forlenza Industrial Systems\nAll rights reserved.');
                    break;
            }
        }

        // Button handlers
        function buttonClick(action) {
            alert('SCADA CONTROL\n\nCommand: ' + action + '\n\nCommand sent to PLC.');
        }

        function emergencyStop() {
            if (confirm('EMERGENCY STOP\n\nThis will halt all processes immediately!\n\nAre you sure?')) {
                alert('EMERGENCY STOP ACTIVATED\n\nAll systems halted.\nManual restart required.');
                document.getElementById('led1').className = 'led red-on';
                document.getElementById('led5').className = 'led red-on';
            }
        }

        // Alarm acknowledgment functions
        function ackAlarm(alarmId) {
            var alarm = document.getElementById(alarmId);
            if (alarm) {
                alarm.className = 'alarm-item acknowledged';
                var ackBtns = alarm.getElementsByTagName('button');
                var ackBtn = null;
                for (var i = 0; i < ackBtns.length; i++) {
                    if (ackBtns[i].className.indexOf('ack-button') !== -1) {
                        ackBtn = ackBtns[i];
                        break;
                    }
                }
                if (ackBtn) {
                    ackBtn.innerHTML = 'ACK\'D';
                    ackBtn.disabled = true;
                    ackBtn.style.backgroundColor = '#606060';
                }
                updateAlarmCount();
            }
        }

        function acknowledgeAll() {
            var alarms = getElementByClassName('alarm-item');
            for (var i = 0; i < alarms.length; i++) {
                if (alarms[i].className.indexOf('acknowledged') === -1) {
                    alarms[i].className = 'alarm-item acknowledged';
                    var ackBtn = getElementByClassName('ack-button', alarms[i])[0];
                    if (ackBtn) {
                        ackBtn.innerHTML = 'ACK\'D';
                        ackBtn.disabled = true;
                        ackBtn.style.backgroundColor = '#606060';
                    }
                }
            }
            updateAlarmCount();
        }

        function clearAcknowledged() {
            var alarmList = document.getElementById('alarm-list');
            var alarms = getElementByClassName('alarm-item', alarmList);
            for (var i = alarms.length - 1; i >= 0; i--) {
                if (alarms[i].className.indexOf('acknowledged') !== -1) {
                    alarmList.removeChild(alarms[i]);
                }
            }
            updateAlarmCount();
        }

        function updateAlarmCount() {
            var alarms = getElementByClassName('alarm-item');
            var unackCount = 0;
            for (var i = 0; i < alarms.length; i++) {
                if (alarms[i].className.indexOf('acknowledged') === -1) {
                    unackCount++;
                }
            }
            var title = document.querySelector('#alarm-list').parentNode.querySelector('.panel-title');
            title.innerHTML = 'ACTIVE ALARMS [' + unackCount + ' UNACK]';

            // Update status bar alarm count
            var statusAlarms = document.getElementById('status-alarms');
            if (statusAlarms) {
                statusAlarms.innerHTML = unackCount;
            }
        }

        // Add new alarm periodically
        function addAlarm() {
            var alarmList = document.getElementById('alarm-list');
            var now = new Date();
            var time = ('0' + now.getHours()).slice(-2) + ':' +
                ('0' + now.getMinutes()).slice(-2) + ':' +
                ('0' + now.getSeconds()).slice(-2);

            var alarms = [
                { text: 'VLV-501 POSITION DEVIATION', priority: 'medium' },
                { text: 'TT-301 TEMPERATURE RISING', priority: 'high' },
                { text: 'P-102 VIBRATION HIGH', priority: 'low' },
                { text: 'FT-401 FLOW RATE LOW', priority: 'medium' },
                { text: 'PT-101 PRESSURE DIFFERENTIAL', priority: 'high' }
            ];

            var alarm = alarms[Math.floor(Math.random() * alarms.length)];
            var num = Math.floor(Math.random() * 500) + 100;
            var newId = 'alarm-' + new Date().getTime();

            var newAlarm = document.createElement('div');
            newAlarm.className = 'alarm-item ' + alarm.priority;
            newAlarm.id = newId;

            var priorityLetter = alarm.priority.charAt(0).toUpperCase();
            newAlarm.innerHTML =
                '<span class="alarm-time">' + time + '</span>' +
                '<span class="alarm-priority">' + priorityLetter + '</span>' +
                '<span class="alarm-text">' + alarm.text + ' ' + num + '</span>' +
                '<span class="alarm-ack-btn"><button class="ack-button" onclick="ackAlarm(\'' + newId + '\')">ACK</button></span>';

            alarmList.insertBefore(newAlarm, alarmList.firstChild);

            // Remove old alarms if too many
            while (alarmList.children.length > 10) {
                alarmList.removeChild(alarmList.lastChild);
            }

            updateAlarmCount();
        }
        setInterval(addAlarm, 30000);

        // Additional gauge updates
        function updateAdditionalGauges() {
            // Power gauge
            var power = 200 + Math.random() * 100;
            document.getElementById('power-value').innerHTML = Math.round(power) + ' kW';
            var powerAngle = -45 + (power - 200) * 0.9;
            rotateNeedle('power-needle', powerAngle);

            // pH gauge
            var ph = 6.8 + Math.random() * 0.8;
            document.getElementById('ph-value').innerHTML = ph.toFixed(1);
            var phAngle = -45 + (ph - 6.8) * 112.5;
            rotateNeedle('ph-needle', phAngle);

            // Vibration display
            var vibration = 0.5 + Math.random() * 0.8;
            document.getElementById('vibration-value').innerHTML = vibration.toFixed(1) + ' mm/s';

            // Update vibration bars
            for (var i = 1; i <= 10; i++) {
                var bar = document.getElementById('vib-bar-' + i);
                var height = 10 + Math.random() * 30;
                bar.style.height = height + 'px';

                // Color coding
                if (height > 25) {
                    bar.className = 'vibration-bar high';
                } else if (height > 18) {
                    bar.className = 'vibration-bar medium';
                } else {
                    bar.className = 'vibration-bar';
                }
            }

            // Tank levels
            var tank1 = 60 + Math.random() * 15;
            var tank2 = 35 + Math.random() * 20;
            var tank3 = 70 + Math.random() * 20;

            document.getElementById('tank1-level').style.height = tank1 + '%';
            document.getElementById('tank1-value').innerHTML = tank1.toFixed(1) + '%';
            document.getElementById('tank2-level').style.height = tank2 + '%';
            document.getElementById('tank2-value').innerHTML = tank2.toFixed(1) + '%';
            document.getElementById('tank3-level').style.height = tank3 + '%';
            document.getElementById('tank3-value').innerHTML = tank3.toFixed(1) + '%';

            // Efficiency metrics
            var oee = 85 + Math.random() * 10;
            var prodRate = 230 + Math.random() * 30;
            var energy = 1200 + Math.random() * 100;
            var efficiency = 90 + Math.random() * 8;

            document.getElementById('oee-value').innerHTML = oee.toFixed(1) + '%';
            document.getElementById('prod-rate').innerHTML = Math.round(prodRate) + ' units/hr';
            document.getElementById('energy-usage').innerHTML = Math.round(energy) + ' kWh';
            document.getElementById('efficiency').innerHTML = efficiency.toFixed(1) + '%';

            // Update bar chart
            for (var j = 1; j <= 8; j++) {
                var bar = document.getElementById('bar' + j);
                var height = 40 + Math.random() * 100;
                bar.style.height = height + 'px';

                // Color coding for production levels
                if (height > 100) {
                    bar.style.backgroundColor = '#00ff00';
                } else if (height > 70) {
                    bar.style.backgroundColor = '#ffff00';
                } else {
                    bar.style.backgroundColor = '#ff8000';
                }
            }
        }
        setInterval(updateAdditionalGauges, 3000);
        updateAdditionalGauges();

        // Valve control function
        function toggleValve(valveId) {
            var valve = document.getElementById(valveId);
            var posText = valve.nextSibling.nextSibling;

            if (valve.className.indexOf('open') > -1) {
                valve.className = 'valve-symbol closed';
                posText.innerHTML = posText.innerHTML.replace('OPEN', 'CLOSED');
            } else {
                valve.className = 'valve-symbol open';
                posText.innerHTML = posText.innerHTML.replace('CLOSED', 'OPEN');
            }
        }

        // Trend chart implementation using canvas
        var trendData = {
            temp: [],
            pressure: [],
            flow: [],
            level: []
        };

        function updateTrendChart() {
            var canvas = document.getElementById('trend-canvas');
            if (!canvas || !canvas.getContext) return; // IE8 fallback

            // Dynamic canvas sizing based on container
            var container = document.getElementById('trend-chart');
            var containerWidth = container.offsetWidth || container.clientWidth || 280;
            var containerHeight = container.offsetHeight || container.clientHeight || 120;

            // Account for padding
            var width = containerWidth - 8;
            var height = containerHeight - 8;

            // Set canvas dimensions
            canvas.width = width;
            canvas.height = height;

            var ctx = canvas.getContext('2d');

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Add new data points
            var temp = 170 + Math.random() * 20;
            var pressure = 2.0 + Math.random() * 1.0;
            var flow = 800 + Math.random() * 100;
            var level = 60 + Math.random() * 20;

            trendData.temp.push(temp);
            trendData.pressure.push(pressure);
            trendData.flow.push(flow);
            trendData.level.push(level);

            // Keep only last 50 points
            if (trendData.temp.length > 50) {
                trendData.temp.shift();
                trendData.pressure.shift();
                trendData.flow.shift();
                trendData.level.shift();
            }

            // Draw trend lines
            function drawTrendLine(data, color, scale, offset) {
                if (data.length < 2) return;

                ctx.strokeStyle = color;
                ctx.lineWidth = 1;
                ctx.beginPath();

                for (var i = 0; i < data.length; i++) {
                    var x = (i / (data.length - 1)) * width;
                    var y = height - ((data[i] - offset) / scale * height);

                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.stroke();
            }

            // Draw each trend line with different colors and scales
            drawTrendLine(trendData.temp, '#00ff00', 30, 160);     // Green for temp (160-190 range)
            drawTrendLine(trendData.pressure, '#ffff00', 2, 1.5);  // Yellow for pressure (1.5-3.5 range)
            drawTrendLine(trendData.flow, '#ff0000', 200, 750);    // Red for flow (750-950 range)
            drawTrendLine(trendData.level, '#00ffff', 40, 50);     // Cyan for level (50-90 range)
        }

        setInterval(updateTrendChart, 5000);
        updateTrendChart();

        // Maintenance timer update
        function updateMaintenanceTimer() {
            var maintTime = document.getElementById('maint-time').innerHTML.split(':');
            var hours = parseInt(maintTime[0]);
            var minutes = parseInt(maintTime[1]);
            var seconds = parseInt(maintTime[2]);

            seconds++;
            if (seconds >= 60) {
                seconds = 0;
                minutes++;
                if (minutes >= 60) {
                    minutes = 0;
                    hours++;
                }
            }

            document.getElementById('maint-time').innerHTML =
                ('00' + hours).slice(-2) + ':' +
                ('00' + minutes).slice(-2) + ':' +
                ('00' + seconds).slice(-2);
        }
        setInterval(updateMaintenanceTimer, 1000);
    </script>
</body>

</html>